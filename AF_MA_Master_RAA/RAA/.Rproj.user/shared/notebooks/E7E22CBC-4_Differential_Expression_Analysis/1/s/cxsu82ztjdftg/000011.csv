"0","run_AFlimma <- function(ExpMat, Targets){"
"0","  library(limma)"
"0","  "
"0","  #Adjust a linear model to the expression data"
"0","  f = factor(Targets$condition, levels= c(""AF"",""SR""))"
"0","  design = model.matrix(~0+f)"
"0","  colnames(design) = c(""yes"",""no"")"
"0","  fit = lmFit(ExpMat, design)"
"0","  "
"0","  #Define contrasts"
"0","  cont.matrix = makeContrasts(AF_sign = yes-no,"
"0","                               levels=design)"
"0","  "
"0","  #Empirical Bayes"
"0","  fit2 = contrasts.fit(fit, cont.matrix)"
"0","  fit2 = eBayes(fit2)"
"0","  "
"0","  #obtain differentially expressed genes"
"0","  AF_results = as.data.frame(topTable(fit2,adjust.method = ""BH"",number = Inf)) %>% "
"0","    tibble::rownames_to_column() %>%"
"0","    arrange(desc(abs(t))) %>% as_tibble()"
"0","  "
"0","  colnames(AF_results)[1] = ""ID"""
"0","  "
"0","  return(AF_results)"
"0","}"
