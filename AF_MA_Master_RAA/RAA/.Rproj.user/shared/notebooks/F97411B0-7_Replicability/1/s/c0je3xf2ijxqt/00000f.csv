"0","# Here we will calculate the enrichment scores for each experiment by creating two lists of differentially expressed genes (upregulated and downregulated), calculate the enrichment scores, and then save the results as RDS files."
"0",""
"0","study_deg_list_up = lapply(AF_Meta, function(x){"
"0","  deg = dplyr::slice(x$AF_limma,"
"0","                     1:500) %>%"
"0","    filter(t >0)"
"0","  return(deg[[1]])"
"0","})"
"0",""
"0","study_deg_list_down = lapply(AF_Meta, function(x){"
"0","  deg = dplyr::slice(x$AF_limma,"
"0","                     1:500) %>%"
"0","    filter(t <0)"
"0","  return(deg[[1]])"
"0","})"
"0",""
"0","# upregulation"
"0",""
"0","up_ES = lapply(experiments, function(x){"
"0","  "
"0","  stat_rank = AF_Meta[[x]][[""AF_limma""]][[""t""]]"
"0","  names(stat_rank) = AF_Meta[[x]][[""AF_limma""]][[""ID""]]"
"0","  stat_rank = sort(stat_rank)"
"0","  set.seed(1234)"
"0","  "
"0","  up_row = as_tibble(fgsea(pathways = study_deg_list_up,"
"0","                           stats = stat_rank,nperm = 1000)) %>%"
"0","    dplyr::select(pathway,ES)"
"0","})"
"2","Warnung: You are trying to run fgseaSimple. It is recommended to use fgseaMultilevel. To run fgseaMultilevel, you need to remove the nperm argument in the fgsea function call."
"2","Warnung: 'package:stats' may not be available when loading"
"2","Warnung: You are trying to run fgseaSimple. It is recommended to use fgseaMultilevel. To run fgseaMultilevel, you need to remove the nperm argument in the fgsea function call."
"2","Warnung: 'package:stats' may not be available when loading"
"2","Warnung: You are trying to run fgseaSimple. It is recommended to use fgseaMultilevel. To run fgseaMultilevel, you need to remove the nperm argument in the fgsea function call."
"2","Warnung: 'package:stats' may not be available when loading"
"2","Warnung: You are trying to run fgseaSimple. It is recommended to use fgseaMultilevel. To run fgseaMultilevel, you need to remove the nperm argument in the fgsea function call."
"2","Warnung: 'package:stats' may not be available when loading"
"2","Warnung: You are trying to run fgseaSimple. It is recommended to use fgseaMultilevel. To run fgseaMultilevel, you need to remove the nperm argument in the fgsea function call."
"2","Warnung: 'package:stats' may not be available when loading"
"2","Warnung: You are trying to run fgseaSimple. It is recommended to use fgseaMultilevel. To run fgseaMultilevel, you need to remove the nperm argument in the fgsea function call."
"2","Warnung: There are ties in the preranked stats (0.3% of the list).
The order of those tied genes will be arbitrary, which may produce unexpected results."
"2","Warnung: 'package:stats' may not be available when loading"
"2","Warnung: You are trying to run fgseaSimple. It is recommended to use fgseaMultilevel. To run fgseaMultilevel, you need to remove the nperm argument in the fgsea function call."
"2","Warnung: 'package:stats' may not be available when loading"
"0","up_ES = up_ES %>% "
"0","  enframe(""Reference"") %>% unnest()"
"2","Warnung: [38;5;232m`cols` is now required when using `unnest()`.
[36mâ„¹[38;5;232m Please use `cols = c(value)`.[39m"
"0","colnames(up_ES) = c(""Reference"",""DEG"",""ES"")"
"0",""
"0","saveRDS(up_ES, "
"0","        file = ""data/figure_objects/up_ES.rds"")"
"0",""
"0",""
"0","# downregulation"
"0",""
"0","down_ES = lapply(experiments, function(x){"
"0","  "
"0","  stat_rank = AF_Meta[[x]][[""AF_limma""]][[""t""]]"
"0","  names(stat_rank) = AF_Meta[[x]][[""AF_limma""]][[""ID""]]"
"0","  stat_rank = sort(stat_rank)"
"0","  set.seed(1234)"
"0","  "
"0","  up_row = as_tibble(fgsea(pathways = study_deg_list_down,"
"0","                           stats = stat_rank,nperm = 1000)) %>%"
"0","    dplyr::select(pathway,ES)"
"0","})"
"2","Warnung: You are trying to run fgseaSimple. It is recommended to use fgseaMultilevel. To run fgseaMultilevel, you need to remove the nperm argument in the fgsea function call."
"2","Warnung: 'package:stats' may not be available when loading"
"2","Warnung: You are trying to run fgseaSimple. It is recommended to use fgseaMultilevel. To run fgseaMultilevel, you need to remove the nperm argument in the fgsea function call."
"2","Warnung: 'package:stats' may not be available when loading"
"2","Warnung: You are trying to run fgseaSimple. It is recommended to use fgseaMultilevel. To run fgseaMultilevel, you need to remove the nperm argument in the fgsea function call."
"2","Warnung: 'package:stats' may not be available when loading"
"2","Warnung: You are trying to run fgseaSimple. It is recommended to use fgseaMultilevel. To run fgseaMultilevel, you need to remove the nperm argument in the fgsea function call."
"2","Warnung: 'package:stats' may not be available when loading"
"2","Warnung: You are trying to run fgseaSimple. It is recommended to use fgseaMultilevel. To run fgseaMultilevel, you need to remove the nperm argument in the fgsea function call."
"2","Warnung: 'package:stats' may not be available when loading"
"2","Warnung: You are trying to run fgseaSimple. It is recommended to use fgseaMultilevel. To run fgseaMultilevel, you need to remove the nperm argument in the fgsea function call."
"2","Warnung: There are ties in the preranked stats (0.3% of the list).
The order of those tied genes will be arbitrary, which may produce unexpected results."
"2","Warnung: 'package:stats' may not be available when loading"
"2","Warnung: You are trying to run fgseaSimple. It is recommended to use fgseaMultilevel. To run fgseaMultilevel, you need to remove the nperm argument in the fgsea function call."
"2","Warnung: 'package:stats' may not be available when loading"
"0","down_ES = down_ES %>% "
"0","  enframe(""Reference"") %>% unnest()"
"2","Warnung: [38;5;232m`cols` is now required when using `unnest()`.
[36mâ„¹[38;5;232m Please use `cols = c(value)`.[39m"
"0","colnames(down_ES) = c(""Reference"",""DEG"",""ES"")"
"0",""
"0","saveRDS(down_ES, "
"0","        file = ""data/figure_objects/down_ES.rds"")"
"0",""
"0",""
"0","## Correlations of reproducibility measures: "
"0","## Here we want to know if high mean enrichment scores"
"0","## for a given study are correlated with their mean AUCs coming"
"0","## from the classification using the disease score"
"0",""
"0","pairwise_200 = dplyr::filter(pairwise_200,"
"0","                             PredictorExperiment != PredictedExperiment) %>% "
"0","               mutate(pairwise = paste(PredictorExperiment,"
"0","                                       PredictedExperiment,"
"0","                                       sep=""_"")) %>%"
"0","  dplyr::select(pairwise,single)"
"0",""
"0","up_ES = dplyr::filter(up_ES,"
"0","                      DEG != Reference) %>%"
"0","              mutate(pairwise = paste(DEG,"
"0","                               Reference,"
"0","                               sep=""_"")) %>%"
"0","  dplyr::select(pairwise,ES)"
"0",""
"0","median(up_ES$ES)"
"1","[1]"
"1"," 0.2976233"
"1","
"
"0","sum(up_ES$ES<0)"
"1","[1]"
"1"," 6"
"1","
"
"0","down_ES = dplyr::filter(down_ES,"
"0","                      DEG != Reference) %>%"
"0","         mutate(pairwise = paste(DEG,"
"0","                          Reference,"
"0","                          sep=""_"")) %>%"
"0","  dplyr::select(pairwise,ES)"
"0",""
"0","median(down_ES$ES)"
"1","[1]"
"1"," -0.3736406"
"1","
"
"0","sum(down_ES$ES>0)"
"1","[1]"
"1"," 4"
"1","
"
"0","reprod_cor_data = left_join(pairwise_200,"
"0","          left_join(up_ES, down_ES, "
"0","                    by = ""pairwise""),"
"0","          by = ""pairwise"")"
"0",""
"0","print(""Correlation of ES with DS (up and down)"")"
"1","[1]"
"1"," ""Correlation of ES with DS (up and down)"""
"1","
"
"0","cor.test(reprod_cor_data$single,reprod_cor_data$ES.x,method = ""pearson"")"
"1","
"
"1","	Pearson's product-moment correlation"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","reprod_cor_data$single and reprod_cor_data$ES.x"
"1",""
"1","
"
"1","t = 8.4574, df = 40, p-value = 1.917e-10"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","correlation"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","0.6567668 0.8885086"
"1",""
"1","
"
"1","sample estimates:
"
"1","      cor "
"1","
"
"1","0.8008407 "
"1","
"
"1","
"
"0","cor.test(reprod_cor_data$single,reprod_cor_data$ES.y,method = ""pearson"")"
"1","
"
"1","	Pearson's product-moment correlation"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","reprod_cor_data$single and reprod_cor_data$ES.y"
"1",""
"1","
"
"1","t = -6.7771, df = 40, p-value = 3.837e-08"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","correlation"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","0"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","-0.8468535 -0.5491971"
"1",""
"1","
"
"1","sample estimates:
"
"1","       cor "
"1","
"
"1","-0.7310953 "
"1","
"
"1","
"
"0","saveRDS(reprod_cor_data, file = ""data/figure_objects/reprod_cor_data.rds"")"
