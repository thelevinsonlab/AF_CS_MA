"0","run_anovastats_AF <- function(numeric_matrix, targets, "
"0","                          factor_a = ""condition"", factor_b = ""ExpID""){"
"0","  library(sjstats)"
"0","  library(fastmatch)"
"0","  "
"0","  anova_res = apply(numeric_matrix, 1, function(x, targets){"
"0","    "
"0","    gene_i = x"
"0","    factor_a_vect = factor(targets[[factor_a]])"
"0","    factor_b_vect = factor(targets[[factor_b]])"
"0","    gene_aov = aov(gene_i ~ factor_a_vect * factor_b_vect)"
"0","    aov_stats = sjstats::anova_stats(gene_aov) "
"0","    "
"0","  },targets = targets)  %>% bind_rows(.id = ""gene"") %>% as_tibble() %>% "
"0","    group_by(gene) %>% gather(stats,value,-(gene:term))  %>% spread(term,value) %>%"
"0","    ungroup()"
"0","  "
"0","  colnames(anova_res)[fmatch(c(""factor_a_vect"",""factor_b_vect"",""factor_a_vect:factor_b_vect""),"
"0","                             colnames(anova_res))] = c(factor_a,factor_b,"
"0","                                                       paste(factor_a,factor_b,sep=""_""))"
"0","  "
"0","  return(anova_res)"
"0","  "
"0","}"
