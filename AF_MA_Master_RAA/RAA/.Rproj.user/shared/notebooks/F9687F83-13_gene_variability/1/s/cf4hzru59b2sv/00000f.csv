"0","get_complete_gex_AF <- function(meta_list, gex_key = ""GEX"","
"0","                            complete_targets){"
"0","  #METAheart object is a "
"0","  "
"0","  all_genes = unique(unlist(lapply(meta_list,"
"0","                                   function(x) rownames(x[[gex_key]]))))"
"0","  "
"0","  gex_union = matrix(NA,nrow = length(all_genes),ncol = nrow(complete_targets))"
"0","  "
"0","  colnames(gex_union) = complete_targets$grl_id"
"0","  rownames(gex_union) = all_genes"
"0","  "
"0","  for(e in unique(complete_targets$ExpID)){"
"0","    fdf = filter(complete_targets,ExpID == e)"
"0","    gex = (meta_list[[e]])[[gex_key]]"
"0","    genes = rownames(gex)[rownames(gex) %in% all_genes]"
"0","    gex_union[genes,fdf$grl_id] = gex"
"0","  }"
"0","  "
"0","  return(gex_union)"
"0","  "
"0","}"
