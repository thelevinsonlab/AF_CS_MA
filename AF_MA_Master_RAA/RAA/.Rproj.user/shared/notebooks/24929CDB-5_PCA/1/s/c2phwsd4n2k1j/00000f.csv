"0","# Finally, we will perform t-distributed Stochastic Neighbor Embedding (t-SNE), which is a machine learning algorithm for visualization, on the z-transformed data."
"0",""
"0","set.seed(9)  "
"0",""
"0","meta_gex_z_naomit_inf <- meta_gex_z_naomit"
"0",""
"0","meta_gex_z_naomit_inf[sapply(meta_gex_z_naomit_inf, simplify = 'matrix', is.infinite)] <- 0"
"0",""
"0","meta_gex_z_naomit_inf = meta_gex_z_naomit_inf[rowSums(is.na(meta_gex_z_naomit_inf))==0,]"
"0",""
"0","nrow(meta_gex_z_naomit_inf)"
"1","[1]"
"1"," 2947"
"1","
"
"0","tsne_model = Rtsne(t(meta_gex_z_naomit_inf[,z_targets$grl_id]),"
"0","                     pca=TRUE, dims=2, perplexity = 15)"
"0",""
"0","# getting the two dimension matrix"
"0","d_tsne = as.data.frame(tsne_model$Y) "
"0",""
"0","tsne_plotdf = z_targets %>% mutate(""tSNE1"" = d_tsne[,1],"
"0","                                   ""tSNE2"" = d_tsne[,2])"
"0",""
"0","saveRDS(tsne_plotdf, file = ""data/figure_objects/tsne_z.rds"")"
