"0","# Filter and format the results of each process accordingly and create plots"
"0",""
"0","#GSEA"
"0","msigdb_filtering = msigdb_datasets %>%"
"0","  arrange(-log2(p.adjust) * sign(NES)) %>%"
"0","  mutate(dir_reg = sign(NES),"
"0","         log_pval = -log10(p.adjust),"
"0","         Sign = ifelse(NES < 0, -1, 1)) %>%"
"0","  arrange(desc(Sign), ifelse(NES < 0, -log_pval, log_pval)) %>%"
"0","  group_by(Sign) %>%"
"0","  top_n(25, wt = log_pval)"
"0",""
"0",""
"0","MSIGDB_plot <- ggplot(msigdb_filtering, aes(x = reorder(ID, log_pval * Sign), y = log_pval, fill = NES)) +"
"0","    geom_bar(stat = ""identity"") +"
"0","    geom_hline(yintercept = -log10(0.25), linetype = ""dashed"", color = ""black"") +"
"0","    scale_fill_gradient2(low = ""darkblue"", high = ""darkred"", "
"0","                         mid = ""whitesmoke"", midpoint = 0) +"
"0","    theme_minimal() +"
"0","    coord_flip() +"
"0","    theme(axis.title = element_text(face = ""bold"", size = 12),"
"0","          axis.text.y = element_text(angle = 0, hjust = 1, size =10, face= ""bold""),"
"0","          axis.text.x = element_text(size =10, face= ""bold""),"
"0","          panel.grid.major = element_blank(), "
"0","          panel.grid.minor = element_blank()) +"
"0","    xlab("""") +"
"0","    ylab(""-log10(BH p-value)"") +"
"0","  theme(legend.position = ""none"")"
"0",""
"0",""
"0","#miRNAs"
"0","mir_filtering = gsea_results_mir_table %>%"
"0","  mutate(log_pval = -log10(p.adjust),"
"0","         Sign = ifelse(NES < 0, -1, 1)) %>%"
"0","  arrange(desc(Sign), ifelse(NES < 0, -log_pval, log_pval)) %>%"
"0","  group_by(Sign) %>%"
"0","  top_n(25, wt = log_pval)"
"0",""
"0",""
"0","miRNA_plot <- ggplot(mir_filtering, aes(x = reorder(ID, log_pval * Sign), y = log_pval, fill = NES)) +"
"0","    geom_bar(stat = ""identity"") +"
"0","    geom_hline(yintercept = -log10(0.25), linetype = ""dashed"", color = ""black"") +"
"0","    scale_fill_gradient2(low = ""darkblue"", high = ""darkred"", "
"0","                         mid = ""whitesmoke"", midpoint = 0) +"
"0","    theme_minimal() +"
"0","    coord_flip() +"
"0","    theme(axis.title = element_text(face = ""bold"", size = 12),"
"0","          axis.text.y = element_text(angle = 0, hjust = 1, size =10, face= ""bold""),"
"0","          axis.text.x = element_text(size =10, face= ""bold""),"
"0","          panel.grid.major = element_blank(), "
"0","          panel.grid.minor = element_blank()) +"
"0","    xlab("""") +"
"0","    ylab(""-log10(BH p-value)"") +"
"0","  theme(legend.position = ""none"")"
"0","  "
"0","#TF"
"0","tf_filtering = contrast_acts_tf %>% dplyr::filter(p_value < 0.05) %>%"
"0","  mutate(log_pval = -log10(p_value),"
"0","         Sign = ifelse(score < 0, ""Negative"", ""Positive"")) %>%"
"0","  arrange(desc(Sign), ifelse(score < 0, -log_pval, log_pval)) %>%"
"0","  group_by(Sign) %>%"
"0","  top_n(25, wt = log_pval)"
"0",""
"0","TF_plot <- ggplot(tf_filtering, aes(x = reorder(source, log_pval * score), y = log_pval, fill = score)) +"
"0","    geom_bar(stat = ""identity"") +"
"0","    geom_hline(yintercept = -log10(0.25), linetype = ""dashed"", color = ""black"") +"
"0","    scale_fill_gradient2(low = ""darkblue"", high = ""darkred"", "
"0","                         mid = ""whitesmoke"", midpoint = 0) +"
"0","    theme_minimal() +"
"0","    coord_flip() +"
"0","    theme(axis.title = element_text(face = ""bold"", size = 12),"
"0","          axis.text.y = element_text(angle = 0, hjust = 1, size =10, face= ""bold""),"
"0","          axis.text.x = element_text(size =10, face= ""bold""),"
"0","          panel.grid.major = element_blank(), "
"0","          panel.grid.minor = element_blank()) +"
"0","    xlab("""") +"
"0","    ylab(""-log10(BH p-value)"") +"
"0","  theme(legend.position = ""none"") "
"0",""
"0","#Pathways"
"0","pathway_filtering = contrast_acts_pathway %>%"
"0","  arrange(-log2(p_value) * sign(score)) %>%"
"0","  mutate(dir_reg = sign(score),"
"0","         log_pval = -log10(p_value),"
"0","         Sign = ifelse(score < 0, ""Negative"", ""Positive"")) %>%"
"0","  arrange(desc(Sign), ifelse(score < 0, -log_pval, log_pval))"
"0",""
"0","Pathway_plot <- ggplot(pathway_filtering, aes(x = reorder(source, log_pval * score), y = log_pval, fill = score)) +"
"0","    geom_bar(stat = ""identity"") +"
"0","    geom_hline(yintercept = -log10(0.25), linetype = ""dashed"", color = ""black"") +"
"0","    scale_fill_gradient2(low = ""darkblue"", high = ""darkred"", "
"0","                         mid = ""whitesmoke"", midpoint = 0) +"
"0","    theme_minimal() +"
"0","    coord_flip() +"
"0","    theme(axis.title = element_text(face = ""bold"", size = 12),"
"0","          axis.text.y = element_text(angle = 0, hjust = 1, size =10, face= ""bold""),"
"0","          axis.text.x = element_text(size =10, face= ""bold""),"
"0","          panel.grid.major = element_blank(), "
"0","          panel.grid.minor = element_blank()) +"
"0","    xlab("""") +"
"0","    ylab(""-log10(BH p-value)"") +"
"0","  theme(legend.position = ""none"")"
