"0","data <- data %>% mutate(intermacs_complete=case_when(intermacs == 1 ~ ""1. Critical cardiogenic shock"","
"0","                                                            intermacs == 2 ~ ""2. Progressive decline"","
"0","                                                            intermacs == 3 ~ ""3. Stable but inotrope dependent"","
"0","                                                            intermacs == 4 ~ ""4. Recurrent advanced heart failure""))"
"0",""
"0","# Prepare the data"
"0","intermacs_summary <- data %>%"
"0","  group_by(intermacs_complete) %>%"
"0","  summarize(count = n(), .groups = 'drop') %>%"
"0","  mutate(percentage = count / sum(count) * 100)"
"0",""
"0","# Define a color palette"
"0","color_palette <- c(""#1A5276"", ""#E74C3C"", ""#1E8449"", ""#E69F00"", ""#D55E00"", ""#CC79A7"", ""#0072B2"")"
"0",""
"0","# Create the pie chart with black borders around segments and labels near the periphery"
"0","pie_plot <- ggplot(intermacs_summary, aes(x = """", y = percentage, fill = factor(intermacs_complete))) +"
"0","  geom_bar(width = 1, stat = ""identity"", color = ""black"") +"
"0","  coord_polar(""y"", start = 0) +"
"0","  scale_fill_manual(values = color_palette) +"
"0","  labs(title = """","
"0","       fill = ""INTERMACS Profile"") +"
"0","  theme_minimal() +"
"0","  theme(plot.title = element_text(hjust = 0.5, size = 36),"
"0","        axis.title = element_blank(),"
"0","        axis.text = element_blank(),"
"0","        axis.ticks = element_blank(),"
"0","        panel.grid = element_blank()) +"
"0","  geom_text(aes(label = paste(round(percentage, 1), ""%"")),"
"0","            position = position_stack(vjust = 0.62),  # Adjust the vjust value to move the labels"
"0","            color = ""white"","
"0","            size = 5)"
"0",""
"0","ggsave(""pie_plot.png"", plot = pie_plot, dpi = 600, width = 10, height = 8, units = ""in"")"
